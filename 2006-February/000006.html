<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Transform-svn] r61 - trunk/src/com/flagstone/transform/examples
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/transform-svn/2006-February/index.html" >
   <LINK REL="made" HREF="mailto:transform-svn%40lists.berlios.de?Subject=Re%3A%20%5BTransform-svn%5D%20r61%20-%20trunk/src/com/flagstone/transform/examples&In-Reply-To=%3C200602211435.k1LEZ3rw015066%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000001.html">
   <LINK REL="Next"  HREF="000002.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Transform-svn] r61 - trunk/src/com/flagstone/transform/examples</H1>
    <B>smackay at berlios.de</B> 
    <A HREF="mailto:transform-svn%40lists.berlios.de?Subject=Re%3A%20%5BTransform-svn%5D%20r61%20-%20trunk/src/com/flagstone/transform/examples&In-Reply-To=%3C200602211435.k1LEZ3rw015066%40sheep.berlios.de%3E"
       TITLE="[Transform-svn] r61 - trunk/src/com/flagstone/transform/examples">smackay at berlios.de
       </A><BR>
    <I>Tue Feb 21 15:35:03 CET 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000001.html">[Transform-svn] r60 - trunk/src/com/flagstone/transform/tools
</A></li>
        <LI>Next message: <A HREF="000002.html">[Transform-svn] r62 - trunk/src/com/flagstone/transform/test
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6">[ date ]</a>
              <a href="thread.html#6">[ thread ]</a>
              <a href="subject.html#6">[ subject ]</a>
              <a href="author.html#6">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: smackay
Date: 2006-02-21 15:34:20 +0100 (Tue, 21 Feb 2006)
New Revision: 61

Added:
   trunk/src/com/flagstone/transform/examples/ConstructButtons.java
   trunk/src/com/flagstone/transform/examples/ConstructImages.java
   trunk/src/com/flagstone/transform/examples/ConstructShapes.java
   trunk/src/com/flagstone/transform/examples/ConstructSounds.java
   trunk/src/com/flagstone/transform/examples/ConstructStreamingSounds.java
   trunk/src/com/flagstone/transform/examples/ConstructText.java
Modified:
   trunk/src/com/flagstone/transform/examples/Example.java
   trunk/src/com/flagstone/transform/examples/Import.java
Log:
com.flagstone.transform.examples: Added examples for the constructor
classes and tidied up some unused variables in existing examples.

Added: trunk/src/com/flagstone/transform/examples/ConstructButtons.java
===================================================================
--- trunk/src/com/flagstone/transform/examples/ConstructButtons.java	2006-02-20 20:31:39 UTC (rev 60)
+++ trunk/src/com/flagstone/transform/examples/ConstructButtons.java	2006-02-21 14:34:20 UTC (rev 61)
@@ -0,0 +1,362 @@
+/*
+ *  BasicButtons.java
+ *  Transform
+ *
+ *  Created by Stuart MacKay on Wed Sep 03 2003.
+ *  Copyright (c) 2001-2004 Flagstone Software Ltd. All rights reserved.
+ *
+ *  This code is distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ *  EXPRESS OR IMPLIED, AND Flagstone HEREBY DISCLAIMS ALL SUCH WARRANTIES, INCLUDING
+ *  WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
+ *  PURPOSE, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS.
+ */
+package com.flagstone.transform.examples;
+
+import com.flagstone.transform.*;
+import com.flagstone.transform.util.*;
+
+import java.util.*;
+
+/*
+ * This example shows how to create buttons using the FSDefineButton and FSDefineButton2
+ * classes. Each button displays a web page in a browser when clicked. The second button
+ * also plays a sound when clicked.
+ *
+ * To run this example, type the following on a command line:
+ *
+ *     java com.flagstone.transform.examples.ConstructButtons \
+ *         --font font-file \
+ *         --sound sound-file \
+ *         --label string \
+ *        [--resultDir path]
+ *
+ * where
+ *
+ *     font-file is the path to a file containing a font definition used to 
+ *     render the text for label on the button.
+ *
+ *     sound-file is the path to a file containing a WAVE or MP3 format sound
+ *     which is played when a button is clicked.
+ *
+ *     string the label that will be displayed on the button - enclose in quotes 
+ *     if the label contains spaces.
+ *
+ *     resultDir is the directory where the Flash file generated by the example 
+ *     is written to.
+ */
+public class ConstructButtons extends Example
+{
+    private FSTextConstructor textGenerator = null;
+    private FSSoundConstructor soundGenerator = null;
+    private FSShapeConstructor path = null;
+
+    public static void main(String[] args)
+    {
+        new ConstructButtons(args);
+    }
+
+    public ConstructButtons(String[] args)
+    {
+        super(args);
+    
+        String fontFile = getOption(&quot;font&quot;, &quot;&quot;);
+        String soundFile = getOption(&quot;sound&quot;, &quot;&quot;);
+    
+        try 
+        {
+            textGenerator = new FSTextConstructor(movie.newIdentifier(), fontFile);
+            soundGenerator = new FSSoundConstructor(soundFile);
+            path = new FSShapeConstructor();
+        }
+        catch (Exception e)
+        {
+            /* Several exceptions could be thrown to get to this point. The 
+             * exceptions are all caught in a single handler to make the code 
+             * more readable.
+             */
+            System.err.println(&quot;Cannot create the movie.&quot;);
+        }
+
+        createMovie();
+    
+        writeFile(&quot;BasicButtons.swf&quot;);
+    }
+    
+    void createMovie()
+    {
+        /*
+         * Arrays used to hold the objects added to the button definitions.
+         */
+        ArrayList records = null;
+        ArrayList actions = null;
+        ArrayList events = null;
+
+        /*
+         * If no label is defined when the example is run then the label 
+         * defaults to &quot;Button&quot;.
+         */
+        String buttonLabel = getOption(&quot;label&quot;, &quot;Button&quot;);
+
+        int layer = 1;       // initial layer in the display list
+        int fontSize = 280;  // 280 twips == 14 point, 1 point == 20 twips
+
+        /*
+         * Define margins added to define the width of the button relative to 
+         * the size of the label and the screen width relative to the width of 
+         * the button.
+         */
+        int buttonMargin = 200; // The margin between the label and the edge of the button.
+        int screenMargin = 400; // The margin between the edge of the button and the screen.
+
+        /*
+         * Define colours used to fill the buttons in each of its states.
+         */
+        FSColor lineColor = FSColorTable.black();
+        FSColor shadowColor = FSColorTable.gray();
+        FSColor upColor = FSColorTable.red();
+        FSColor overColor = FSColorTable.orange();
+
+        /*
+         * Define coordinate transform applied to the basic button shape 
+         * to perform a simple animation giving the impression the button
+         * was physically clicked.
+         */
+        FSCoordTransform recess = new FSCoordTransform(60, 60);
+
+        /*
+         * Define the shapes used to create the buttons.
+         *
+         * The size of the shapes is calculated relative to the bounding rectangle
+         * enclosing an arbitrary long label. The ascent of the text is used rather
+         * than the full height of the bounding rectangle as this gives better
+         * placement of the text relative to the button edges.
+         */
+        FSDefineShape3 label = textGenerator.defineShape(movie.newIdentifier(), 
+            buttonLabel, fontSize, lineColor);
+
+        // define a 10 pixel margin around the text.
+    
+        int buttonWidth = label.getBounds().getWidth() + buttonMargin;
+        int buttonHeight = -label.getBounds().getMinY() + buttonMargin;
+
+        int lineWidth = 20;
+        int cornerRadius = 100;
+
+        /*
+         * The button will cast as shadow when it in the up state. Recessing the 
+         * button by changing the location of the shapes when the button is 
+         * clicked allows a very simple animation to be performed. More complex 
+         * animations can be created by using movie clips.
+         */
+        int xShadow = 60;
+        int yShadow = 60;
+
+        /*
+         * Used to hold the width and height of the bounding rectangle that
+         * encloses the button labels.
+         */
+        int width = 0;
+        int height = 0;
+        
+        path.add(new FSSolidLine(lineWidth, shadowColor));
+        path.add(new FSSolidFill(shadowColor));
+        path.rect(0, 0, buttonWidth, buttonHeight, cornerRadius);
+        
+        FSDefineShape2 shadow = path.defineShape(movie.newIdentifier());
+            
+        path.set(0, new FSSolidLine(lineWidth, lineColor));
+        path.set(0, new FSSolidFill(upColor));
+        path.rect(0, 0, buttonWidth, buttonHeight, cornerRadius);
+        
+        FSDefineShape2 upShape = path.defineShape(movie.newIdentifier());
+
+        path.set(0, new FSSolidLine(lineWidth, lineColor));
+        path.set(0, new FSSolidFill(overColor));
+        path.rect(0, 0, buttonWidth, buttonHeight, cornerRadius);
+        
+        FSDefineShape2 overShape = path.defineShape(movie.newIdentifier());
+
+        /**************************
+         *      First Button
+         **************************/
+
+        /*
+         * This button is created using the FSDefineButton class which only 
+         * defines actions when the button is clicked. The FSDefineButton2 class 
+         * supports a more complex model that allows actions to be performed for 
+         * a wide range of different button events.
+         */
+        records = new ArrayList();
+        actions = new ArrayList();
+        events = new ArrayList();
+
+        /*
+         * Define the label. For the first button the label text is traced out 
+         * as a shape. In the second half of this example the text object is 
+         * used directly.
+         */
+        FSDefineShape3 firstLabel = textGenerator.defineShape(movie.newIdentifier(), 
+            buttonLabel, fontSize, lineColor);
+
+        /*
+         * Realign the labels so they are displayed in the centre of the button. 
+         * The ascent of the text is used rather than the full height of the 
+         * bounding rectangle.
+         */
+        width = firstLabel.getBounds().getWidth();
+        height = -firstLabel.getBounds().getMinY();
+
+        /*
+         * Create the FSButto objects that define the button's appearance. More 
+         * than one button record can be defined for a given state allowing for 
+         * example button definitions to be reused with only the label changing. 
+         * The layer number controls the order in which the shapes are displayed.
+         *
+         * Use one of the button shapes to define the active area where the 
+         * button will respond to events generated by the mouse.
+         */
+        records.add(new FSButton(FSButton.Active, upShape.getIdentifier(), layer++));
+
+        /*
+         * Define the appearance of the button in the up state. A shape giving a 
+         * drop shadow effect is placed in the background and the label is in 
+         * the foreground.
+         */
+        records.add(new FSButton(FSButton.Up, shadow.getIdentifier(), layer++, recess));
+        records.add(new FSButton(FSButton.Up, upShape.getIdentifier(), layer++));
+        records.add(new FSButton(FSButton.Up, firstLabel.getIdentifier(), layer++, 
+            new FSCoordTransform(-width/2, height/2)));
+
+        /*
+         * The button appears the same when the mouse is over the active area. 
+         * Only the colour changes to highlight the button. The drop shadow must 
+         * still be drawn.     
+         */
+        records.add(new FSButton(FSButton.Over, shadow.getIdentifier(), layer++, recess));
+        records.add(new FSButton(FSButton.Over, overShape.getIdentifier(), layer++));
+        records.add(new FSButton(FSButton.Over, firstLabel.getIdentifier(), layer++, 
+            new FSCoordTransform(-width/2, height/2)));
+
+        /*
+         * The button appears is recessed when it is clicked so the shape for the drop shadow is
+         * not required.
+         */
+        records.add(new FSButton(FSButton.Down, overShape.getIdentifier(), layer++, recess));
+        records.add(new FSButton(FSButton.Down, firstLabel.getIdentifier(), layer++, 
+            new FSCoordTransform(-width/2 + xShadow, height/2 + yShadow)));
+
+        /*
+         * When the button is clicked a web page will be loaded into the web 
+         * browser. The browser must be running for this to work, the Flash Player 
+         * won't launch the browser by itself.
+         */
+        actions.add(new FSGetUrl(&quot;<A HREF="http://www.flagstonesoftware.com">http://www.flagstonesoftware.com</A>&quot;, &quot;&quot;));
+
+        FSDefineButton firstButton = new FSDefineButton(movie.newIdentifier(), 
+            records, actions);
+
+
+        /**************************
+         *     Second Button
+         **************************/
+
+        /*
+         * The second button is created using the FSDefineButton2 class which 
+         * provides a richer model for responding to moue events. It is similar 
+         * in appearance to the first except that the label is created using 
+         * FSDefineText2 objects rather than tracing out the text as a shape.
+         */
+        records = new ArrayList();
+        actions = new ArrayList();
+        events = new ArrayList();
+    
+        /*
+         * The FSDefineText2 object contains an FSCoordTransform which is used 
+         * here to change the placement of the text so the label appears in the 
+         * middle of the button.
+         */
+        FSDefineText2 secondLabel = textGenerator.defineText(movie.newIdentifier(), 
+            buttonLabel, fontSize, lineColor);
+
+        width = secondLabel.getBounds().getWidth();
+        height = - secondLabel.getBounds().getMinY();
+
+        /*
+         * Add the button records that define the button's appearance
+         */
+        records.add(new FSButton(FSButton.Active, upShape.getIdentifier(), layer++));
+
+        records.add(new FSButton(FSButton.Up, shadow.getIdentifier(), layer++, recess));
+        records.add(new FSButton(FSButton.Up, upShape.getIdentifier(), layer++));
+        records.add(new FSButton(FSButton.Up, secondLabel.getIdentifier(), layer++, 
+            new FSCoordTransform(-width/2, height/2)));
+
+        records.add(new FSButton(FSButton.Over, shadow.getIdentifier(), layer++, recess));
+        records.add(new FSButton(FSButton.Over, overShape.getIdentifier(), layer++));
+        records.add(new FSButton(FSButton.Over, secondLabel.getIdentifier(), layer++, 
+            new FSCoordTransform(-width/2, height/2)));
+
+        records.add(new FSButton(FSButton.Down, overShape.getIdentifier(), layer++, recess));
+        records.add(new FSButton(FSButton.Down, secondLabel.getIdentifier(), layer++, 
+            new FSCoordTransform(-width/2 + xShadow, height/2 + yShadow)));
+
+        /*
+         * FSDefineButton2 contains a series of FSButtonEvent objects that define 
+         * the eactions performed in response to different mouse events. As in 
+         * the previous example a web page will be loaded into the web browser 
+         * when the button is clicked.
+         */
+        actions.add(new FSGetUrl(&quot;<A HREF="http://www.flagstonesoftware.com">http://www.flagstonesoftware.com</A>&quot;, &quot;&quot;));
+    
+        events.add(new FSButtonEvent(FSButtonEvent.Release, actions));
+
+        FSDefineButton2 secondButton = new FSDefineButton2(movie.newIdentifier(), 
+            FSDefineButton2.Push, records, events);
+
+        FSDefineSound sound = soundGenerator.defineSound(movie.newIdentifier());
+        
+        FSButtonSound buttonSound = new FSButtonSound(secondButton.getIdentifier(), 
+            FSButtonEvent.Release, new FSSound(sound.getIdentifier(), 0));    
+
+        /***************************************************
+         *     Put all the objects together in a movie
+         ***************************************************/
+
+        /*
+         * Make the screen tall enough for a column of five buttons.
+         */
+        int screenWidth = buttonWidth + 2*screenMargin;
+        int rowHeight = buttonHeight + screenMargin;
+        
+        movie.setFrameSize(new FSBounds(0, 0, screenWidth, rowHeight*2));
+        movie.setFrameRate(1.0f);
+        movie.add(new FSSetBackgroundColor(FSColorTable.lightblue()));
+
+        // Add the font definition for the text labels
+        movie.add(textGenerator.defineFont());
+
+        // Add the shapes used to define the buttons
+        movie.add(shadow);
+        movie.add(upShape);
+        movie.add(overShape);
+
+        // Add the first button and show it in the first row
+        movie.add(firstLabel);
+        movie.add(firstButton);
+
+        movie.add(new FSPlaceObject2(firstButton.getIdentifier(), layer++, 
+            screenWidth/2 , rowHeight/2));
+
+        // Add the second button and show it in the second row
+        movie.add(secondLabel);
+        movie.add(secondButton);
+
+        movie.add(sound);
+        movie.add(buttonSound);
+
+        movie.add(new FSPlaceObject2(secondButton.getIdentifier(), layer++, 
+            screenWidth/2 , rowHeight + rowHeight/2));
+
+        movie.add(new FSShowFrame());
+    }
+}

Added: trunk/src/com/flagstone/transform/examples/ConstructImages.java
===================================================================
--- trunk/src/com/flagstone/transform/examples/ConstructImages.java	2006-02-20 20:31:39 UTC (rev 60)
+++ trunk/src/com/flagstone/transform/examples/ConstructImages.java	2006-02-21 14:34:20 UTC (rev 61)
@@ -0,0 +1,120 @@
+/*
+ *  ShowImage.java
+ *  Examples
+ *
+ *  Created by Stuart MacKay on Fri Jul 25 2003.
+ *  Copyright (c) 2001-2004 Flagstone Software Ltd. All rights reserved.
+ *
+ *  This code is distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ *  EXPRESS OR IMPLIED, AND Flagstone HEREBY DISCLAIMS ALL SUCH WARRANTIES, INCLUDING
+ *  WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
+ *  PURPOSE, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS.
+ */
+package com.flagstone.transform.examples;
+
+import com.flagstone.transform.*;
+import com.flagstone.transform.util.*;
+
+import java.io.*;
+
+/*
+ * This example shows how image can be displayed using the FSImageConstructor.
+ *
+ * To run this example, type the following on a command line:
+ *
+ *     java com.flagstone.transform.examples.ConstructImages 
+ *         --file image-file [--resultDir path]
+ *     
+ * where
+ *
+ *     image-file is the path to a file containing either BMP, PNG or JPEG image.
+ *
+ *     resultDir is the directory where the Flash file generated by the example 
+ *     is written to.
+ *
+ * The name of the Flash file generated is the same as the image file with the 
+ * file extension replaced with a '.swf' suffix.
+ */
+public class ConstructImages extends Example
+{
+    private FSImageConstructor imageGenerator = null;  
+
+    public static void main(String[] args)
+    {
+        new ConstructImages(args);
+    }
+    
+    public ConstructImages(String[] args)
+    {
+        super(args);
+    
+        String imageFile = getOption(&quot;file&quot;, &quot;&quot;);
+            
+        try 
+        {
+            /* Create the FSImageConstructor object used to generate the object
+             * containing the image definition. Initialize it using the name of 
+             * the image file passed on the command line when the exanple was run.
+             */
+            imageGenerator = new FSImageConstructor(imageFile);  
+            
+            /* Create the name of the Flash file generated using the name of the 
+             * font file - adding a '.swf' suffix.
+             */
+            int first = imageFile.lastIndexOf(File.separatorChar);
+            int last = imageFile.lastIndexOf('.');
+            
+            String fileOut = resultDir + File.separator + imageFile.substring(first, last) + &quot;.swf&quot;;
+    
+            createMovie(imageFile);
+            
+            movie.encodeToFile(fileOut);
+        }
+        catch (Exception e)
+        {
+            /* Several exceptions could be thrown to get to this point. FSImageConstructor
+             * will throw a FileNotFoundException, IOException or DataFormatException 
+             * if the image format is not support or if an error occurs while
+             * loading and decoding the image data.
+             * 
+             * The FSMovie will throw a FileNotFoundException or IOException if 
+             * there is a problem generating the Flash file.
+             * 
+             * The exceptions are all caught in a single handler to make the code more 
+             * readable.
+             */
+            System.err.println(&quot;Cannot create movie for the image: &quot; + imageFile);
+        }
+     }
+    
+    public void createMovie(String filename)
+    {
+        int imageId = movie.newIdentifier();
+        int shapeId = movie.newIdentifier();
+        
+        int xOrigin = imageGenerator.getWidth()/2;
+        int yOrigin = imageGenerator.getHeight()/2;
+        
+        // Generate the image defintion
+        FSDefineObject image = imageGenerator.defineImage(imageId);
+        
+        /*
+         * All images must be displayed as a bitmap fill inside a shape. The 
+         * FSImageConstructor class generates the shape enclosing the image.
+         * If no border is required then the line style may be set to null.
+         */
+        FSDefineShape3 shape = imageGenerator.defineEnclosingShape(shapeId, imageId, 
+            -xOrigin, -yOrigin, new FSSolidLine(20, FSColorTable.black()));
+        
+        /* 
+         * Add all the objects together to create the movie.
+         */
+        movie.setFrameRate(1.0f);
+        movie.setFrameSize(shape.getBounds());
+        movie.add(new FSSetBackgroundColor(FSColorTable.lightblue()));
+        movie.add(image);
+        movie.add(shape);
+        movie.add(new FSPlaceObject2(shapeId, 1, 0, 0));
+        movie.add(new FSShowFrame());
+    }
+}
\ No newline at end of file

Added: trunk/src/com/flagstone/transform/examples/ConstructShapes.java
===================================================================
--- trunk/src/com/flagstone/transform/examples/ConstructShapes.java	2006-02-20 20:31:39 UTC (rev 60)
+++ trunk/src/com/flagstone/transform/examples/ConstructShapes.java	2006-02-21 14:34:20 UTC (rev 61)
@@ -0,0 +1,230 @@
+/*
+ *  BasicShapes.java
+ *  Examples
+ *
+ *  Created by Stuart MacKay on Fri Jul 25 2003.
+ *  Copyright (c) 2001-2004 Flagstone Software Ltd. All rights reserved.
+ *
+ *  This code is distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ *  EXPRESS OR IMPLIED, AND Flagstone HEREBY DISCLAIMS ALL SUCH WARRANTIES, INCLUDING
+ *  WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
+ *  PURPOSE, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS.
+ */
+package com.flagstone.transform.examples;
+
+import com.flagstone.transform.*;
+import com.flagstone.transform.util.*;
+
+/*
+ * This example shows how the drawing commands available in the FSShapeConstructor
+ * can be used to draw simple geometic shapes and arbitrary paths. The example 
+ * draws a series of simple geometic shapes and discusses how the line and fill
+ * styles are specified to render the paths drawn.
+ *
+ * To run this example, type the following on a command line:
+ *
+ *     java com.flagstone.transform.examples.ConstructShapes [--resultDir path]
+ 
+ * where
+ *
+ *     resultDir is the directory where the Flash file generated by the example 
+ *     is written to. The file will be written to the directory where the example
+ *     was run if omitted.
+ */
+public class ConstructShapes extends Example
+{
+    public static void main(String[] args)
+    {
+        new ConstructShapes(args);
+    }
+    
+    public ConstructShapes(String[] args)
+    {
+        super(args);
+    
+        createMovie();
+    
+        writeFile(&quot;BasicShapes.swf&quot;);
+    }
+    
+    public void createMovie()
+    {
+        FSShapeConstructor path = new FSShapeConstructor();
+        
+        /* The FSShapeConstructor allows coordinates to be specified either 
+         * in twips or pixels. Pixels makes life a little easier.
+         */
+        path.COORDINATES_ARE_PIXELS = true;
+        
+        int width = 150;
+        int height = 100;
+        int cornerRadius = 10;
+        int identifier = 0;
+        
+        /* The line and fill styles used to render the shapes should be 
+         * specified before drawing starts. The line style is the most 
+         * important since the thickness of the line determines the size of 
+         * the bounding rectangle which must completely enclose the shape for 
+         * it to be drawn correctly - particularly if overlapped by other 
+         * shapes on different layers in the display list or when used to draw
+         * buttons.
+         * 
+         * Here the same line and fill styles are being used to draw each of the 
+         * shapes. More typically the line and fille styles would be set for 
+         * each of the shapes drawn. The class provides getLineStyles() and 
+         * getFillStyles() methods to access the line and fill style arrays 
+         * allowing tight control over reusing or replacing styles as each
+         * shape is drawn.
+         */
+        path.add(new FSSolidLine(20, FSColorTable.black()));
+        path.add(new FSSolidFill(FSColorTable.red()));
+        
+        movie.setFrameRate(1.0f);
+        movie.setFrameSize(new FSBounds(-4000, -4000, 4000, 4000));
+        movie.add(new FSSetBackgroundColor(FSColorTable.lightblue()));
+        
+        /* Draw a rectangle with the origin at the centre of the shape.
+         * 
+         * First select the line and fill styles by specifying the order of the
+         * styles added to the FSShapeConstructor earlier - the styles are stored
+         * in two arrays one for the line styles and one for the fill styles.
+         * 
+         * All the methods used to draw geometic shapes allow the origin of the
+         * shape to be specified. The coordinate system of the shape is separate
+         * from the coordinate system of the movie. Specifying the origin controls 
+         * how the shape is drawn relative to the point on the screen where it 
+         * is placed.
+         * 
+         * The identifier variable is reused for each shape definition since they
+         * are not referred to other than to place them on the display list using
+         * the FSPlaceObject2 class.
+         * 
+         * All the methods provided to draw geometic shapes are implemented
+         * using the methods that perform the basic drawing commands supported
+         * by the FSShapeConstructor class. For example the rect() method used 
+         * here is implemented as:
+         * 
+         * public void rect(int x, int y, int width, int height)
+         * {
+         *     newPath();
+         *     setStyle(0, 0);
+         *     move(x-width/2, y-height/2);
+         *     rline(width, 0);
+         *     rline(0, height);
+         *     rline(-width, 0);
+         *     rline(0, -height);
+         *     closePath();
+         * }
+         */
+        identifier = movie.newIdentifier();
+        
+        path.rect(width/2, -height/2, width, height);
+        
+        /* Add the shape definition to the movie, place on the display list
+         * and render the frame.
+         */
+        movie.add(path.defineShape(identifier));
+        movie.add(new FSPlaceObject2(identifier, 1, 0, 0));
+        movie.add(new FSShowFrame());
+        
+        /*
+         * Draw a rectangle with rounded corners.
+         * 
+         * Here the first drawing command is a call to newPath() which clears
+         * any path currently being drawn. It should be the first command before
+         * and drawing or style selections are made.
+         */
+        identifier = movie.newIdentifier();
+
+        path.rect(width/2, height/2, width, height, cornerRadius);
+        
+        movie.add(path.defineShape(identifier));
+        movie.add(new FSPlaceObject2(identifier, 1));
+        movie.add(new FSShowFrame());
+
+        /*
+         * Draw a circle
+         */
+        identifier = movie.newIdentifier();
+
+        path.circle(-width/2, height/2, height/2);
+        
+        movie.add(path.defineShape(identifier));
+        movie.add(new FSPlaceObject2(identifier, 1));
+        movie.add(new FSShowFrame());
+        
+        /*
+         * Draw a elipse
+         */
+        identifier = movie.newIdentifier();
+
+        path.ellipse(-width/2, -height/2, width/2, height/2);
+        
+        movie.add(path.defineShape(identifier));
+        movie.add(new FSPlaceObject2(identifier, 1));
+        movie.add(new FSShowFrame());
+        
+        /*
+         * Draw a polyline.
+         * 
+         * The first point of a polyline is a move relative to the current 
+         * drawing point - which for a new path is (0,0). While the geometic
+         * shapes drawn previous were all closed the polygon method can be 
+         * used to draw part of a shape so the newPath() and styles must be 
+         * explicitly specified to draw the shape.
+         */
+        identifier = movie.newIdentifier();
+
+        int[] points = new int[] { 
+            0, -100, 
+            10, 0, 
+            0, 90, 
+            90, 0, 
+            0, 20,
+            -90, 0,
+            0, 90,
+            -20, 0,
+            0, -90,
+            -90, 0,
+            0, -20,
+            90, 0,
+            0, -90,
+            10, 0
+        };
+
+        path.newPath();
+        path.selectStyle(0, 0);
+        path.polygon(points);
+        
+        movie.add(path.defineShape(identifier));
+        movie.add(new FSPlaceObject2(identifier, 1));
+        movie.add(new FSShowFrame());
+        
+        /*
+         * Draw a cubic bezier curve
+         * 
+         * This simple curve is included to show how cubic Bezier curves are 
+         * drawn. Flash only directly supports quadratic Bezier curves. Converting
+         * from cubic to quadratic is mathematically difficult so the cubic curve
+         * is flattened and drawn as a series of striaght lines. The results are 
+         * visually appealing and the slight increase in the size of the Flash 
+         * file is compensated for by the increase in drawing performance.
+         * 
+         * Note that the path is closed before the shape is generated. The 
+         * FSImageConstructor tracks the initial and current drawing points. When
+         * a closePath() call is made it draws a straight line (if required)
+         * between the current point and the initial point to ensure that the 
+         * shape is closed and will be rendered correctly.
+         */
+        identifier = movie.newIdentifier();
+
+        path.newPath();
+        path.selectStyle(0, 0);
+        path.curve(0, -100, 150, -100, 150, 0);
+        path.closePath();
+        
+        movie.add(path.defineShape(identifier));
+        movie.add(new FSPlaceObject2(identifier, 1));
+        movie.add(new FSShowFrame());
+    }
+}
\ No newline at end of file

Added: trunk/src/com/flagstone/transform/examples/ConstructSounds.java
===================================================================
--- trunk/src/com/flagstone/transform/examples/ConstructSounds.java	2006-02-20 20:31:39 UTC (rev 60)
+++ trunk/src/com/flagstone/transform/examples/ConstructSounds.java	2006-02-21 14:34:20 UTC (rev 61)
@@ -0,0 +1,134 @@
+/*
+ *  BasicSounds.java
+ *  Examples
+ *
+ *  Created by Stuart MacKay on Fri Jun 06 2003.
+ *  Copyright (c) 2001-2004 Flagstone Software Ltd. All rights reserved.
+ *
+ *  This code is distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ *  EXPRESS OR IMPLIED, AND Flagstone HEREBY DISCLAIMS ALL SUCH WARRANTIES, INCLUDING
+ *  WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
+ *  PURPOSE, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS.
+ */
+package com.flagstone.transform.examples;
+
+import com.flagstone.transform.*;
+import com.flagstone.transform.util.*;
+
+import java.io.*;
+
+/*
+ * This example shows how the FSSoundConstructor class can be used to generate
+ * the objects used to play a sound in a movie.
+ *
+ * To run this example, type the following on a command line:
+ *
+ *     java com.flagstone.transform.examples.ConstructSounds 
+ *         --file sound-file [--resultDir path]
+ *
+ * where
+ *
+ *     sound-file is the path to a file containing a WAVE or MP3 format sound.
+ *
+ *     resultDir is the directory where the Flash file generated by the example 
+ *     is written to.
+ *
+ */
+public class ConstructSounds extends Example
+{    
+    private FSSoundConstructor soundGenerator = null;
+
+    public static void main(String[] args)
+    {
+        new ConstructSounds(args);
+    }
+
+    public ConstructSounds(String[] args)
+    {
+        super(args);
+    
+        String soundFile = getOption(&quot;file&quot;, &quot;&quot;);
+            
+        /* Create the name of the Flash file generated using the name of the 
+         * sound file - replaciing the file extension with '.swf'.
+         */
+        int first = soundFile.lastIndexOf(File.separatorChar);
+        int last = soundFile.lastIndexOf('.');
+            
+        String fileOut = resultDir + File.separator + soundFile.substring(first, last) + &quot;.swf&quot;;
+    
+        try 
+        {
+            /* Create the FSSoundConstructor object used to generate the object
+             * that defines the sound. Initialize it using the name of the 
+             * sound file passed on the command line when the exanple was run.
+             */
+            soundGenerator = new FSSoundConstructor(soundFile);
+
+            createMovie();
+    
+            movie.encodeToFile(fileOut);
+        }
+        catch (Exception e)
+        {
+            /* Several exceptions could be thrown to get to this point. The 
+             * FSSoundConstructor will throw a FileNotFoundException, IOException 
+             * or DataFormatException if the sound is not the correct format or
+             * if an error occurs while loading the file and extracting the
+             * sound.
+             * 
+             * The FSMovie will throw a FileNotFoundException or IOException if 
+             * there is a problem generating the Flash file.
+             * 
+             * The exceptions are all caught in a single handler to make the code 
+             * more readable.
+             */
+            System.err.println(&quot;Cannot create file for sound:&quot; + soundFile);
+        }
+    }
+    
+    void createMovie()
+    {
+        float framesPerSecond = 12.0f;
+        int soundId = movie.newIdentifier();
+
+        /*
+         * Calculate the time it takes to play the sound and the number of frames 
+         * this represents.
+         */
+        float duration = ((float) soundGenerator.getSamplesPerChannel()) / 
+            ((float) soundGenerator.getSampleRate());
+            
+        int numberOfFrames = (int) (duration * framesPerSecond);
+        
+        /*
+         * Add the sound definition and the FSStartSound object which is used to start
+         * the sound playing.
+         */
+        
+        //if (soundGenerator.getFormat() == FSSound.PCM)
+        //    soundGenerator.compressADPCM(5);
+        
+        FSDefineSound sound = soundGenerator.defineSound(soundId);
+        
+        /* 
+         * Add all the objects together to create the movie.
+         */
+        movie.setFrameSize(new FSBounds(0, 0, 8000, 4000));
+        movie.setFrameRate(framesPerSecond);
+        movie.add(new FSSetBackgroundColor(FSColorTable.lightblue()));
+        movie.add(sound);
+        
+        /*
+         * Signal the Flash Player to begin playing the sound.
+         */
+        movie.add(new FSStartSound(new FSSound(soundId, FSSound.Start)));
+
+        /* 
+         * Add enough frames to give the sound time to play.
+         */
+        for (int i=0; i&lt;numberOfFrames; i++)
+            movie.add(new FSShowFrame());
+
+    }
+}
\ No newline at end of file

Added: trunk/src/com/flagstone/transform/examples/ConstructStreamingSounds.java
===================================================================
--- trunk/src/com/flagstone/transform/examples/ConstructStreamingSounds.java	2006-02-20 20:31:39 UTC (rev 60)
+++ trunk/src/com/flagstone/transform/examples/ConstructStreamingSounds.java	2006-02-21 14:34:20 UTC (rev 61)
@@ -0,0 +1,119 @@
+/*
+ *  StreamingSounds.java
+ *  Examples
+ *
+ *  Created by Stuart MacKay on Fri Jun 06 2003.
+ *  Copyright (c) 2001-2004 Flagstone Software Ltd. All rights reserved.
+ *
+ *  This code is distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, 
+ *  EITHER EXPRESS OR IMPLIED, AND Flagstone HEREBY DISCLAIMS ALL SUCH WARRANTIES, 
+ *  INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR 
+ *  A PARTICULAR PURPOSE, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS.
+ */
+package com.flagstone.transform.examples;
+
+import com.flagstone.transform.*;
+import com.flagstone.transform.util.*;
+
+import java.io.*;
+
+/*
+ * This example shows how the FSSoundConstructor class can be used to generate
+ * the objects used to play streaming sounds in a movie.
+ *
+ * For an example of how to play a sound in response to a button being clicked see
+ * the Buttons example.
+ *
+ * To run this example, type the following on a command line:
+ *
+ *     java com.flagstone.transform.examples.ConstructStreamingSounds 
+ *         --file sound-file [--resultDir path]
+ *
+ * where
+ *
+ *     sound-file is the path to a file containing a WAVE or MP3 format sound.
+ *
+ *     resultDir is the directory where the Flash file generated by the example 
+ *     is written to.
+ *
+ */
+public class ConstructStreamingSounds extends Example
+{
+    private FSSoundConstructor soundGenerator = null;
+
+    public static void main(String[] args)
+    {
+        new ConstructStreamingSounds(args);
+    }
+
+    public ConstructStreamingSounds(String[] args)
+    {
+        super(args);
+    
+        String soundFile = getOption(&quot;file&quot;, &quot;&quot;);
+            
+        /* Create the name of the Flash file generated using the name of the 
+         * sound file - replaciing the file extension with '.swf'.
+         */
+        int first = soundFile.lastIndexOf(File.separatorChar);
+        int last = soundFile.lastIndexOf('.');
+        
+        String fileOut = soundFile.substring(first, last) + &quot;.swf&quot;;
+    
+        try 
+        {
+            soundGenerator = new FSSoundConstructor(soundFile);
+        }
+        catch (Exception e)
+        {
+            /* Several exceptions could be thrown to get to this point. The 
+             * FSSoundConstructor will throw a FileNotFoundException, IOException 
+             * or DataFormatException if the sound is not the correct format or
+             * if an error occurs while loading the file and extracting the
+             * sound.
+             * 
+             * The exceptions are all caught in a single handler to make the code 
+             * more readable.
+             */
+            System.err.println(&quot;Cannot load sound file:&quot; + soundFile);
+        }
+
+        createMovie();
+    
+        writeFile(fileOut);
+    }
+    
+    void createMovie()
+    {
+        float framesPerSecond = 12.0f;
+
+        /*
+         * Calculate the number of decoded sound samples played for each frame and
+         * the size, in bytes, of each block compressed sound data.
+         */
+        int samplesPerBlock = soundGenerator.getSampleRate() / (int) framesPerSecond;
+        int numberOfBlocks = soundGenerator.getSamplesPerChannel() / samplesPerBlock;
+
+        /* 
+         * Add all the objects together to create the movie.
+         */
+        movie.setFrameSize(new FSBounds(0, 0, 8000, 4000));
+        movie.setFrameRate(framesPerSecond);
+        movie.add(new FSSetBackgroundColor(FSColorTable.lightblue()));
+
+        /* 
+         * An FSSoundStreamHeader2 object defines the attributes of the streaming sound.
+         */
+        movie.add(soundGenerator.streamHeader(samplesPerBlock));
+
+        /* 
+         * Add a streaming block for each frame so the sound is played as each frame 
+         * is displayed.
+         */
+        for (int i=0; i&lt;numberOfBlocks; i++)
+        {
+            movie.add(soundGenerator.streamBlock(i, samplesPerBlock));
+            movie.add(new FSShowFrame());
+        }
+    }
+}
\ No newline at end of file

Added: trunk/src/com/flagstone/transform/examples/ConstructText.java
===================================================================
--- trunk/src/com/flagstone/transform/examples/ConstructText.java	2006-02-20 20:31:39 UTC (rev 60)
+++ trunk/src/com/flagstone/transform/examples/ConstructText.java	2006-02-21 14:34:20 UTC (rev 61)
@@ -0,0 +1,174 @@
+/*
+ *  ShowAWTFonts.java
+ *  Examples
+ *
+ *  Created by Stuart MacKay on Wed Sep 03 2003.
+ *  Copyright (c) 2001-2004 Flagstone Software Ltd. All rights reserved.
+ *
+ *  This code is distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ *  EXPRESS OR IMPLIED, AND Flagstone HEREBY DISCLAIMS ALL SUCH WARRANTIES, INCLUDING
+ *  WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
+ *  PURPOSE, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS.
+ */
+package com.flagstone.transform.examples;
+
+import com.flagstone.transform.*;
+import com.flagstone.transform.util.*;
+
+import java.io.*;
+import java.util.*;
+import java.awt.*;
+
+/*
+ * This example shows how the FSTextConstructor class can be used to generate a 
+ * font defintion using the fonts built into the Java AWT toolkit. The example
+ * loads the font definition and generates a movie displaying the first 2048 
+ * characters as a block of text containing 32 rows of 64 characters - enough
+ * to display all the characters displayed in Latin and Cyrillic fonts along
+ * with the majority of special characters and symbols.
+ *
+ * To run this example, type the following on a command line:
+ *
+ *     java com.flagstone.transform.examples.ConstructText [--resultDir path]
+ *
+ * where
+ *
+ *     resultDir is the directory where the Flash files generated by the example 
+ *     is written to. The files will be written to the directory where the example
+ *     was run if omitted.
+ *
+ * The example will generate one Flash file for each of the fonts available. The 
+ * names of the font will be used as the filename with a '.swf' suffix added.
+ */
+public class ConstructText extends Example
+{
+    private FSTextConstructor textGenerator = null;
+    
+    public static void main(String[] args)
+    {
+        new ConstructText(args);
+    }
+
+    public ConstructText(String[] args)
+    {
+        super(args);
+    
+        String fontName = null;
+        String fileOut = null;
+        
+        try 
+        {
+            Font[] fonts = GraphicsEnvironment.getLocalGraphicsEnvironment().getAllFonts();
+            
+            for (int i=0; i&lt;fonts.length; i++)
+            {
+                movie = new FSMovie();
+
+                fontName = fonts[i].getFontName();
+                fileOut = resultDir + File.separator + fontName + &quot;.swf&quot;;
+                
+                /*
+                 * Font definitions for AWT fonts are created by specifying the name
+                 * of the font. Flash and OpenType/TrueType fonts are generated by 
+                 * specifying the name of the file containing the font definition.
+                 */
+                textGenerator = new FSTextConstructor(movie.newIdentifier(), fontName);
+
+                createMovie();
+    
+                movie.encodeToFile(fileOut);
+            }
+        }
+        catch (Exception e)
+        {
+            /* Several exceptions could be thrown to get to this point. FSTextConstructor
+             * will throw an IllegalArgumentException font cannot be loaded from the 
+             * graphics environment. The constructor will also throw a FileNotFoundException,
+             * IOException or DataFormatException if the font is being loaded from a file.
+             * 
+             * The FSMovie will throw a FileNotFoundException or IOException if there is a 
+             * problem creating the file.
+             * 
+             * The exceptions are all caught in a single handler to make the code more 
+             * readable.
+             */
+            System.err.println(&quot;Cannot create movie for the font: &quot; + fontName);
+            
+            e.printStackTrace();
+        }
+    }
+        
+    void createMovie()
+    {
+        int layer = 0;                // Starting layer for objects in the display list.
+        int fontSize = 280;           // Font size in twips 1 point = 20 twips
+        int lineSpacing = fontSize;   // The font size defines a suitable line spacing
+        
+        /*
+         * The movie will be sized to match the block of text generated.
+         * The margins are defined so the text is displayed without touching
+         * the edge of the Flash Player screen.
+         */
+        int leftMargin = fontSize;
+        int rightMargin = fontSize;
+        int topMargin = fontSize;
+        int bottomMargin = fontSize;
+        
+        /* Create the strings that will be used to display the text. The first
+         * 2048 characters availalbe in the font will be shown as a block of
+         * 32 lines each containing 64 characters.
+         */
+        ArrayList lines = new ArrayList();
+        char c = 0;
+
+        for (int i=0; i&lt;32; i++)
+        {
+            StringBuffer line = new StringBuffer();
+            
+            for (int j=0; j&lt;64; j++, c++)
+            {
+                line.append((char)c);
+            }
+            lines.add(line.toString());
+        }
+        
+        /* The block of text is generated before the font definition. This ensures
+         * that only the characters displayed will be included in the font. Unused
+         * characters will be omitted, greatly reducing the size of the Flash file
+         * generated. Once the FSDefineFont2 object has been generated any text 
+         * objects created with characters not previously used, will not be 
+         * displayed correctly - a new font definition would need to be generated
+         * to include the new characters.
+         * 
+         * The FSDefineText2 object contains an array of FSText objects, each
+         * specifying an offset relative to the origin of the entire block. These
+         * can easily be changed if a line needs to be indented or the line spacing
+         * adjusted. 
+         */
+        FSDefineText2 text = textGenerator.defineTextBlock(movie.newIdentifier(), 
+            lines, fontSize, FSColorTable.black(), lineSpacing);
+            
+        FSDefineFont2 font = textGenerator.defineFont();
+
+        /* Define the size of the Flash Player screen using the bounding 
+         * rectangle defined for the block of text plus a suitable margin so 
+         * the text does not touch the edge of the screen.
+         */
+        int screenWidth = text.getBounds().getWidth() + leftMargin + rightMargin;
+        int screenHeight = text.getBounds().getHeight() + topMargin + bottomMargin;
+        
+        /* 
+         * Add all the objects together to create the movie. The origin of the 
+         * block of text (0,0) is the top left corner as viewed on the Flash 
+         * Player screen. The left and top margins offsets the text correctly
+         * from the edge of the screen.
+         */
+        movie.setFrameSize(new FSBounds(0, 0, screenWidth, screenHeight));
+        movie.setFrameRate(1.0f);
+        movie.add(new FSSetBackgroundColor(FSColorTable.lightblue()));
+        movie.add(font);
+        movie.add(text);
+        movie.add(new FSPlaceObject2(text.getIdentifier(), layer++, leftMargin , topMargin));
+        movie.add(new FSShowFrame());
+    }
+}

Modified: trunk/src/com/flagstone/transform/examples/Example.java
===================================================================
--- trunk/src/com/flagstone/transform/examples/Example.java	2006-02-20 20:31:39 UTC (rev 60)
+++ trunk/src/com/flagstone/transform/examples/Example.java	2006-02-21 14:34:20 UTC (rev 61)
@@ -13,11 +13,11 @@
 
 package com.flagstone.transform.examples;
 
-import com.flagstone.transform.*;
 import java.util.*;
 import java.util.zip.*;
 import java.io.*;
 
+import com.flagstone.transform.*;
 /*
  * The Example class is used as a parent class for each of the examples that 
  * illustrate how different Flash features are generated using the Transform SWF
@@ -167,7 +167,7 @@
      * @return the int associated with the option or the default value if 
      * the option was not specified on the command line.
      */
-       public int getOption(String name, int defaultValue)
+    public int getOption(String name, int defaultValue)
     {
         int value = defaultValue;
         

Modified: trunk/src/com/flagstone/transform/examples/Import.java
===================================================================
--- trunk/src/com/flagstone/transform/examples/Import.java	2006-02-20 20:31:39 UTC (rev 60)
+++ trunk/src/com/flagstone/transform/examples/Import.java	2006-02-21 14:34:20 UTC (rev 61)
@@ -49,9 +49,6 @@
     
     public void createMovie()
     {
-        int width = 3200;
-        int height = 2400;
-    
         int fontSize = 240;
         int leading = 80;
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000001.html">[Transform-svn] r60 - trunk/src/com/flagstone/transform/tools
</A></li>
	<LI>Next message: <A HREF="000002.html">[Transform-svn] r62 - trunk/src/com/flagstone/transform/test
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6">[ date ]</a>
              <a href="thread.html#6">[ thread ]</a>
              <a href="subject.html#6">[ subject ]</a>
              <a href="author.html#6">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/transform-svn">More information about the Transform-svn
mailing list</a><br>
</body></html>
